
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>European Parliament groups and how they vote &#8212; Proximidades e distâncias: análise da actividade parlamentar, 2015-2021</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabulator.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/fsm.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/tabulator.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="2021 Presidential Elections: using GeoJSON and Wikipedia" href="Presidenciais_2021_wiki.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/pperdidos_2.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Proximidades e distâncias: análise da actividade parlamentar, 2015-2021</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Início
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Introdução
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="actual.html">
   1. O que é novo, e o que se mantém
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro_metodo.html">
   2. Metodologia e resultados: visão geral
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Análise das legislaturas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="l13.html">
   3. A XIII Legislatura: o princípio
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="l14.html">
   4. Continuidade e fim: a XIV Legislatura
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="comp_anos.html">
   5. As votações no tempo: comparação das legislaturas e anos
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Os Orçamentos
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="OE2021.html">
   6. Orçamento de Estado de 2021
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Notas finais
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="conc.html">
   7. Conclusão
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bib.html">
   8. Biliografia
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Apêndices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dados.html">
   Os dados das Legislaturas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dados-OE2021.html">
   Os dados do Orçamento de Estado de 2021
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="metodo_det.html">
   Em maior detalhe
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="met_distmat.html">
     Distâncias e matrizes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="met_cluster.html">
     Métodos de
     <em>
      clustering
     </em>
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Apócrifos
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Presidenciais_2021_wiki.html">
   2021 Presidential Elections: using GeoJSON and Wikipedia
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   European Parliament groups and how they vote
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/European_Parliament.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/fsmunoz/pt-act-parlamentar"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/fsmunoz/pt-act-parlamentar/issues/new?title=Issue%20on%20page%20%2FEuropean_Parliament.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/fsmunoz/pt-act-parlamentar/jbook?urlpath=tree/parlamento2015-21/European_Parliament.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   European Parliament groups and how they vote
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-data">
   Importing data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#looking-at-the-data">
     Looking at the data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#who-votes-with-whom-determining-convergence-in-voting">
     Who votes with whom? Determining convergence in voting
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-distance-matrix-of-the-political-groups">
     The Distance Matrix of the political groups
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dbscan-and-spectrum-clustering">
     DBSCAN and Spectrum Clustering
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multidimensional-scaling">
     Multidimensional Scaling
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mds-per-policy-area">
     MDS per Policy Area
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="european-parliament-groups-and-how-they-vote">
<h1>European Parliament groups and how they vote<a class="headerlink" href="#european-parliament-groups-and-how-they-vote" title="Permalink to this headline">¶</a></h1>
<p>Based on a set of 3299 votes obtained through <a class="reference external" href="http://VoteWatch.eu">VoteWatch.eu</a> we create a dataset for analysis using Pandas. Using initial data visualisation techniques (like heatmaps), we then obtain an euclidean distance matrix between all political groups pairs.
A cluster map is created from the distance matrix using Ward clustering, presenting the way the different groups cluster together in a dendogram that shows the relative distance between all of them.</p>
<p>Using DBSCAN and SpectrumClustering in the computed affinity matrix we obtain the separate groups that can be identified by both methods, and using Multi-dimensional scaling we create 2D and 3D maps of the relative distance between all groups - in total and by Policy Area.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="importing-data">
<h1>Importing data<a class="headerlink" href="#importing-data" title="Permalink to this headline">¶</a></h1>
<p>This data was extracted from <a class="reference external" href="http://votewatch.eu">http://votewatch.eu</a> - a site I recommend to anyone to that wants to follow the political activity in the EU; it consists of ~3300 votes from the last quarter of 2020.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eu_v</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Date</th>
      <th>Policy Area</th>
      <th>Name</th>
      <th>For</th>
      <th>Against</th>
      <th>Abstentions</th>
      <th>Result</th>
      <th>GUE-NGL</th>
      <th>S&amp;D</th>
      <th>Greens/EFA</th>
      <th>REG</th>
      <th>EPP</th>
      <th>ECR</th>
      <th>IDG</th>
      <th>NI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2324</td>
      <td>9/14/2020</td>
      <td>Transport &amp; tourism</td>
      <td>Sustainable rail market in view of COVID-19 ou...</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>Adopted</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2325</td>
      <td>9/14/2020</td>
      <td>Budget</td>
      <td>Draft amending budget no 8: Increase of paymen...</td>
      <td>62</td>
      <td>0</td>
      <td>2</td>
      <td>Adopted</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2326</td>
      <td>9/14/2020</td>
      <td>Regional development</td>
      <td>Proposal for a Council decision authorising Po...</td>
      <td>64</td>
      <td>0</td>
      <td>1</td>
      <td>Adopted</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2327</td>
      <td>9/14/2020</td>
      <td>Culture &amp; education</td>
      <td>Effective measures to “green” Erasmus+, Creati...</td>
      <td>65</td>
      <td>0</td>
      <td>0</td>
      <td>Adopted</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>Against</td>
      <td>Abstain</td>
      <td>For</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2328</td>
      <td>9/14/2020</td>
      <td>Environment &amp; public health</td>
      <td>The EU’s role in protecting and restoring the ...</td>
      <td>65</td>
      <td>0</td>
      <td>0</td>
      <td>Adopted</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
      <td>For</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Each row is a vote and the columns include the political groups position (as defined by <a class="reference external" href="http://VoteWatch.eu">VoteWatch.eu</a>), the result and the policy area, amongst others.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eu_v</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;ID&#39;, &#39;Date&#39;, &#39;Policy Area&#39;, &#39;Name&#39;, &#39;For&#39;, &#39;Against&#39;, &#39;Abstentions&#39;,
       &#39;Result&#39;, &#39;GUE-NGL&#39;, &#39;S&amp;D&#39;, &#39;Greens/EFA&#39;, &#39;REG&#39;, &#39;EPP&#39;, &#39;ECR&#39;, &#39;IDG&#39;,
       &#39;NI&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="section" id="looking-at-the-data">
<h2>Looking at the data<a class="headerlink" href="#looking-at-the-data" title="Permalink to this headline">¶</a></h2>
<p>Information on the political groups can be obtained directly from the European Parliament site (<a class="reference external" href="https://www.europarl.europa.eu/about-parliament/en/organisation-and-rules/organisation/political-groups">https://www.europarl.europa.eu/about-parliament/en/organisation-and-rules/organisation/political-groups</a>); a very brief description based on the above information and direct quotes (when possible) from their official sites:</p>
<ul class="simple">
<li><p><strong>Group of the European People’s Party (Christian Democrats)</strong>: “The EPP Group is the largest and oldest group in the European Parliament. A centre-right group, we are committed to creating a stronger and self-assured Europe, built at the service of its people. Our goal is to create a more competitive and democratic Europe, where people can build the life they want.”</p></li>
<li><p><strong>Group of the Progressive Alliance of Socialists and Democrats</strong>: “The S&amp;D Group is the leading centre-left political group in the European Parliament and the second largest. Our MEPs are committed to fighting for social justice, jobs and growth, consumer rights, sustainable development, financial market reform and human rights to create a stronger and more democratic Europe and a better future for everyone.”</p></li>
<li><p><strong>Renew Europe Group</strong>: “There has never been a larger centrist group in the European Parliament. By ending the dominance of the Conservatives and the Socialists, Europeans have given us a strong mandate to change Europe for the better. At a time when the rule of law and democracy are under threat in parts of Europe, our Group will stand up for the people who suffer from the illiberal and nationalistic tendencies that we see returning in too many countries.”</p></li>
<li><p><strong>Group of the Greens/European Free Alliance</strong>: “The Greens/European Free Alliance is a political group in the European Parliament made up of Green, Pirate and Independent MEPs as well as MEPs from parties representing stateless nations and disadvantaged minorities. The Greens/EFA project is to build a society respectful of fundamental human rights and environmental justice: the rights to self-determination, to shelter, to good health, to education, to culture, and to a high quality of life”</p></li>
<li><p><strong>Identity and Democracy Group</strong>: “Identity and Democracy (ID) is a new group, which is the fourth largest one in the current European Parliament”; “The Members of the ID Group base their political project on the upholding of freedom, sovereignty,  subsidiarity  and  the  identity  of  the  European  peoples  and  nations.  They  acknowledge  the  Greek-Roman  and  Christian  heritage  as the  pillars  of  European  civilisation.”</p></li>
<li><p><strong>European Conservatives and Reformists Group</strong>: “The ECR Group is a centre-right political group in the European Parliament, founded in 2009 with a common cause to reform the EU based on euro-realism, respecting the sovereignty of nations, and focusing on economic recovery, growth and competitiveness. From its 8 founding Member States with 54 MEPs in 2009, we now have 62 members from 15 EU Member States. The ECR Group is at the forefront of generating forward-looking policy proposals to design a reformed European Union that is more flexible, decentralised and respects the wishes of its Member States. Only an EU that truly listens to its people can offer real solutions to the problems we face today. “</p></li>
<li><p><strong>The Left group in the European Parliament - GUE/NGL</strong>: “Our group brings together left-wing MEPs in the European Parliament. We stand up for workers, environment, feminism, peace &amp; human rights. What unites us is the vision of a socially equitable and sustainable Europe based on international solidarity. The European Union must become a project of its people and cannot remain a project of the elites. We want equal rights for women and men, civil rights and liberties and the enforcement of human rights. Anti-Fascism and anti-racism are also a strong part of the tradition of left movements in Europe.”</p></li>
</ul>
<p>There is an additional group listed in the table: <em>NI</em>, which stands for <em>Non-Inscrits</em>: this isn’t strictly speaking a group but it bundles every MEP that doesn’t belong to a group. As per the wikipedia article (<a class="reference external" href="https://en.wikipedia.org/wiki/Non-Inscrits">https://en.wikipedia.org/wiki/Non-Inscrits</a>) the current MEPs come from different political backgrounds.</p>
<p>To visualise how the different groups vote an initial approach is a simple heatmap; for that end we subset the dataframe on the political groups only and replace the voting indication with numerical values.</p>
<p>The resulting dataframe is simply a list of voting sessions with a numeric indication of each group’s vote:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">votes_hm</span><span class="o">=</span><span class="n">eu_v</span><span class="p">[[</span><span class="s2">&quot;GUE-NGL&quot;</span><span class="p">,</span><span class="s2">&quot;S&amp;D&quot;</span><span class="p">,</span> <span class="s2">&quot;Greens/EFA&quot;</span><span class="p">,</span> <span class="s2">&quot;REG&quot;</span><span class="p">,</span> <span class="s2">&quot;EPP&quot;</span><span class="p">,</span> <span class="s2">&quot;ECR&quot;</span><span class="p">,</span> <span class="s2">&quot;IDG&quot;</span><span class="p">,</span> <span class="s2">&quot;NI&quot;</span><span class="p">]]</span>
<span class="n">votes_hmn</span> <span class="o">=</span> <span class="n">votes_hm</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s2">&quot;For&quot;</span><span class="p">,</span> <span class="s2">&quot;Against&quot;</span><span class="p">,</span> <span class="s2">&quot;Abstain&quot;</span><span class="p">,</span> <span class="s2">&quot;No political line&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">votes_hmn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GUE-NGL</th>
      <th>S&amp;D</th>
      <th>Greens/EFA</th>
      <th>REG</th>
      <th>EPP</th>
      <th>ECR</th>
      <th>IDG</th>
      <th>NI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3294</th>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3295</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>-1</td>
      <td>0</td>
      <td>-1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3296</th>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3297</th>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3298</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>3299 rows × 8 columns</p>
</div></div></div>
</div>
<p>Using Seaborn (<a class="reference external" href="https://seaborn.pydata.org/">https://seaborn.pydata.org/</a>) we can then visualise it.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>


<span class="n">voting_palette</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#FB6962&quot;</span><span class="p">,</span><span class="s2">&quot;#FCFC99&quot;</span><span class="p">,</span><span class="s2">&quot;#79DE79&quot;</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">votes_hmn</span><span class="p">,</span>
            <span class="n">square</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">yticklabels</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">voting_palette</span><span class="p">),</span>
           <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/European_Parliament_11_0.png" src="_images/European_Parliament_11_0.png" />
</div>
</div>
<p>This visualisation alone can provide some initial insights; for example, the IDG seems to abstain more than the rest, and the ECR group appears to vote against more than the average. In general groups in the centre-right to right-wing seem to vote more Against than the others.</p>
</div>
<div class="section" id="who-votes-with-whom-determining-convergence-in-voting">
<h2>Who votes with whom? Determining convergence in voting<a class="headerlink" href="#who-votes-with-whom-determining-convergence-in-voting" title="Permalink to this headline">¶</a></h2>
<p>An initial approach to determine how similar or dissimilar the groups are is simply to determine how many times they have voted exactly in the same way, which is what the following table reflects:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">collections</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">pv_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#print(&quot;Total voting instances: &quot;, votes_hm.shape[0])</span>

<span class="c1">## Not necessarily the most straightforard way (check .crosstab or .pivot_table, possibly with pandas.melt and/or groupby)</span>
<span class="c1">## but follows the same approach as before in using a list of dicts</span>
<span class="k">for</span> <span class="n">party</span> <span class="ow">in</span> <span class="n">votes_hm</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">pv_dict</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">votes_hmn</span><span class="p">:</span>
        <span class="n">pv_dict</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">=</span><span class="n">votes_hmn</span><span class="p">[</span><span class="n">votes_hmn</span><span class="p">[</span><span class="n">party</span><span class="p">]</span> <span class="o">==</span> <span class="n">votes_hmn</span><span class="p">[</span><span class="n">column</span><span class="p">]]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">pv_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pv_dict</span><span class="p">)</span>

<span class="n">pv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pv_list</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">votes_hm</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">pv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GUE-NGL</th>
      <th>S&amp;D</th>
      <th>Greens/EFA</th>
      <th>REG</th>
      <th>EPP</th>
      <th>ECR</th>
      <th>IDG</th>
      <th>NI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>GUE-NGL</th>
      <td>3299</td>
      <td>2318</td>
      <td>2670</td>
      <td>2026</td>
      <td>1612</td>
      <td>978</td>
      <td>940</td>
      <td>2433</td>
    </tr>
    <tr>
      <th>S&amp;D</th>
      <td>2318</td>
      <td>3299</td>
      <td>2642</td>
      <td>2841</td>
      <td>2449</td>
      <td>1571</td>
      <td>1087</td>
      <td>2536</td>
    </tr>
    <tr>
      <th>Greens/EFA</th>
      <td>2670</td>
      <td>2642</td>
      <td>3299</td>
      <td>2370</td>
      <td>1943</td>
      <td>1184</td>
      <td>866</td>
      <td>2690</td>
    </tr>
    <tr>
      <th>REG</th>
      <td>2026</td>
      <td>2841</td>
      <td>2370</td>
      <td>3299</td>
      <td>2708</td>
      <td>1790</td>
      <td>1233</td>
      <td>2255</td>
    </tr>
    <tr>
      <th>EPP</th>
      <td>1612</td>
      <td>2449</td>
      <td>1943</td>
      <td>2708</td>
      <td>3299</td>
      <td>2162</td>
      <td>1504</td>
      <td>1947</td>
    </tr>
    <tr>
      <th>ECR</th>
      <td>978</td>
      <td>1571</td>
      <td>1184</td>
      <td>1790</td>
      <td>2162</td>
      <td>3299</td>
      <td>1916</td>
      <td>1265</td>
    </tr>
    <tr>
      <th>IDG</th>
      <td>940</td>
      <td>1087</td>
      <td>866</td>
      <td>1233</td>
      <td>1504</td>
      <td>1916</td>
      <td>3299</td>
      <td>1028</td>
    </tr>
    <tr>
      <th>NI</th>
      <td>2433</td>
      <td>2536</td>
      <td>2690</td>
      <td>2255</td>
      <td>1947</td>
      <td>1265</td>
      <td>1028</td>
      <td>3299</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Using a heatmap (but this time for a different purpose and with different options) we can visualise that data in a better way.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
    <span class="n">pv</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;mako_r&quot;</span><span class="p">),</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">square</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
    <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;European Parliament, identical voting count (2020-08-01 to 2021-01-01)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/European_Parliament_16_0.png" src="_images/European_Parliament_16_0.png" />
</div>
</div>
<p>From this we can see, for example, that the party with whom GUE/NGL has converged the least is the IDG (and vice-versa), or that S&amp;D converges more with the REG (and vice-versa).
This approach, while already useful, only considers the proximity based on absolute convergence - is there a better way?</p>
</div>
<div class="section" id="the-distance-matrix-of-the-political-groups">
<h2>The Distance Matrix of the political groups<a class="headerlink" href="#the-distance-matrix-of-the-political-groups" title="Permalink to this headline">¶</a></h2>
<p>One improvement is to reflect the differences in voting behaviour: a party that votes In Favour is closer to a party that Abstains than to one that votes Against.
Based on this principle we compute the euclidean pairwise distance between all groups and create a distance matrix.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">squareform</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
<span class="kn">import</span> <span class="nn">scipy.spatial</span> <span class="k">as</span> <span class="nn">sp</span><span class="o">,</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="k">as</span> <span class="nn">hc</span>
<span class="kn">from</span> <span class="nn">itables</span> <span class="kn">import</span> <span class="n">show</span>

<span class="n">votes_hmn</span> <span class="o">=</span> <span class="n">votes_hmn</span>

<span class="c1">## Transpose the dataframe used for the heatmap</span>
<span class="n">votes_t</span> <span class="o">=</span> <span class="n">votes_hmn</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="c1">## Determine the Eucledian pairwise distance</span>
<span class="c1">## (&quot;euclidean&quot; is actually the default option)</span>
<span class="n">pwdist</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">votes_t</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>

<span class="c1">## Create a square dataframe with the pairwise distances: the distance matrix</span>
<span class="n">distmat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">squareform</span><span class="p">(</span><span class="n">pwdist</span><span class="p">),</span> <span class="c1"># pass a symmetric distance matrix</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="n">votes_t</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">votes_t</span><span class="o">.</span><span class="n">index</span>
<span class="p">)</span>

<span class="n">distmat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GUE-NGL</th>
      <th>S&amp;D</th>
      <th>Greens/EFA</th>
      <th>REG</th>
      <th>EPP</th>
      <th>ECR</th>
      <th>IDG</th>
      <th>NI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>GUE-NGL</th>
      <td>0.000000</td>
      <td>59.974995</td>
      <td>45.155288</td>
      <td>69.354164</td>
      <td>80.318118</td>
      <td>90.972523</td>
      <td>89.218832</td>
      <td>52.009614</td>
    </tr>
    <tr>
      <th>S&amp;D</th>
      <td>59.974995</td>
      <td>0.000000</td>
      <td>48.435524</td>
      <td>41.988094</td>
      <td>57.323643</td>
      <td>77.711003</td>
      <td>86.434947</td>
      <td>49.879856</td>
    </tr>
    <tr>
      <th>Greens/EFA</th>
      <td>45.155288</td>
      <td>48.435524</td>
      <td>0.000000</td>
      <td>58.932164</td>
      <td>71.833140</td>
      <td>86.377080</td>
      <td>90.746901</td>
      <td>42.000000</td>
    </tr>
    <tr>
      <th>REG</th>
      <td>69.354164</td>
      <td>41.988094</td>
      <td>58.932164</td>
      <td>0.000000</td>
      <td>47.906158</td>
      <td>72.166474</td>
      <td>83.078276</td>
      <td>60.224580</td>
    </tr>
    <tr>
      <th>EPP</th>
      <td>80.318118</td>
      <td>57.323643</td>
      <td>71.833140</td>
      <td>47.906158</td>
      <td>0.000000</td>
      <td>60.819405</td>
      <td>76.256147</td>
      <td>69.598851</td>
    </tr>
    <tr>
      <th>ECR</th>
      <td>90.972523</td>
      <td>77.711003</td>
      <td>86.377080</td>
      <td>72.166474</td>
      <td>60.819405</td>
      <td>0.000000</td>
      <td>60.149813</td>
      <td>82.903558</td>
    </tr>
    <tr>
      <th>IDG</th>
      <td>89.218832</td>
      <td>86.434947</td>
      <td>90.746901</td>
      <td>83.078276</td>
      <td>76.256147</td>
      <td>60.149813</td>
      <td>0.000000</td>
      <td>85.924385</td>
    </tr>
    <tr>
      <th>NI</th>
      <td>52.009614</td>
      <td>49.879856</td>
      <td>42.000000</td>
      <td>60.224580</td>
      <td>69.598851</td>
      <td>82.903558</td>
      <td>85.924385</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The findings can be read in a similar way to the previous analysis: for example, the Greens/EFA is closer to the NI group and furthest awy from the IDG, while the EPP is most distant from GUE/NGL and has the REG has the closest group.</p>
<p>This pairwise analysis can fortunately be groups automatically; for this we use Ward clustering to obtain a dendogram that can be combined with a heatmap: a <em>clustermap</em> that has the advantage of automatically reordering the columns and rows to show how the groups are positioned in terms of distance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Perform hierarchical linkage on the distance matrix using Ward&#39;s method.</span>
<span class="n">distmat_link</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">linkage</span><span class="p">(</span><span class="n">pwdist</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;ward&quot;</span><span class="p">,</span> <span class="n">optimal_ordering</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">clustermap</span><span class="p">(</span>
    <span class="n">distmat</span><span class="p">,</span>
    <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;Greens_r&quot;</span><span class="p">),</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="c1">#standard_scale=1,</span>
    <span class="n">row_linkage</span><span class="o">=</span><span class="n">distmat_link</span><span class="p">,</span>
    <span class="n">col_linkage</span><span class="o">=</span><span class="n">distmat_link</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;European Parliament, euclidean distance and Ward clustering </span><span class="se">\n</span><span class="s1">(2020-08-01 to 2021-01-01), Clustermap&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/European_Parliament_20_0.png" src="_images/European_Parliament_20_0.png" />
</div>
</div>
<p>The results are much more readable: we can clearly see that:</p>
<ul class="simple">
<li><p>The first split separates the IDG and ECR from the rest.</p></li>
<li><p>The next split separates the EPP, REF and S&amp;D (the last two closer together)</p></li>
<li><p>Finally the GUE/NGL, the Greens/EFA and the NI constitute a separate branch (with GUE/NGL branching out first)</p></li>
</ul>
</div>
<div class="section" id="dbscan-and-spectrum-clustering">
<h2>DBSCAN and Spectrum Clustering<a class="headerlink" href="#dbscan-and-spectrum-clustering" title="Permalink to this headline">¶</a></h2>
<p>An additional line of inquery is to determine, based on the relative affinity, how many groups can be identified, or how do the parties cluster when divided by a fixed number of clusters.</p>
<p>The first step in answering this is to compute the affinity matrix from the distance matrix. We start by normalising the distance matrix.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">distmat_mm</span><span class="o">=</span><span class="p">((</span><span class="n">distmat</span><span class="o">-</span><span class="n">distmat</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span><span class="p">(</span><span class="n">distmat</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">distmat</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span><span class="o">*</span><span class="mi">1</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">distmat_mm</span><span class="p">,</span> <span class="n">distmat</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">distmat</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GUE-NGL</th>
      <th>S&amp;D</th>
      <th>Greens/EFA</th>
      <th>REG</th>
      <th>EPP</th>
      <th>ECR</th>
      <th>IDG</th>
      <th>NI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>GUE-NGL</th>
      <td>0.000000</td>
      <td>0.659265</td>
      <td>0.496362</td>
      <td>0.762364</td>
      <td>0.882883</td>
      <td>1.000000</td>
      <td>0.980723</td>
      <td>0.571707</td>
    </tr>
    <tr>
      <th>S&amp;D</th>
      <td>0.659265</td>
      <td>0.000000</td>
      <td>0.532419</td>
      <td>0.461547</td>
      <td>0.630120</td>
      <td>0.854225</td>
      <td>0.950121</td>
      <td>0.548296</td>
    </tr>
    <tr>
      <th>Greens/EFA</th>
      <td>0.496362</td>
      <td>0.532419</td>
      <td>0.000000</td>
      <td>0.647802</td>
      <td>0.789614</td>
      <td>0.949485</td>
      <td>0.997520</td>
      <td>0.461678</td>
    </tr>
    <tr>
      <th>REG</th>
      <td>0.762364</td>
      <td>0.461547</td>
      <td>0.647802</td>
      <td>0.000000</td>
      <td>0.526600</td>
      <td>0.793278</td>
      <td>0.913224</td>
      <td>0.662008</td>
    </tr>
    <tr>
      <th>EPP</th>
      <td>0.882883</td>
      <td>0.630120</td>
      <td>0.789614</td>
      <td>0.526600</td>
      <td>0.000000</td>
      <td>0.668547</td>
      <td>0.838233</td>
      <td>0.765054</td>
    </tr>
    <tr>
      <th>ECR</th>
      <td>1.000000</td>
      <td>0.854225</td>
      <td>0.949485</td>
      <td>0.793278</td>
      <td>0.668547</td>
      <td>0.000000</td>
      <td>0.661187</td>
      <td>0.911303</td>
    </tr>
    <tr>
      <th>IDG</th>
      <td>0.980723</td>
      <td>0.950121</td>
      <td>0.997520</td>
      <td>0.913224</td>
      <td>0.838233</td>
      <td>0.661187</td>
      <td>0.000000</td>
      <td>0.944509</td>
    </tr>
    <tr>
      <th>NI</th>
      <td>0.571707</td>
      <td>0.548296</td>
      <td>0.461678</td>
      <td>0.662008</td>
      <td>0.765054</td>
      <td>0.911303</td>
      <td>0.944509</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can now obtain the affinity matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">affinmat_mm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">distmat_mm</span><span class="p">,</span> <span class="n">distmat</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">distmat</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">affinmat_mm</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GUE-NGL</th>
      <th>S&amp;D</th>
      <th>Greens/EFA</th>
      <th>REG</th>
      <th>EPP</th>
      <th>ECR</th>
      <th>IDG</th>
      <th>NI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>GUE-NGL</th>
      <td>1.000000</td>
      <td>0.340735</td>
      <td>0.503638</td>
      <td>0.237636</td>
      <td>0.117117</td>
      <td>0.000000</td>
      <td>0.019277</td>
      <td>0.428293</td>
    </tr>
    <tr>
      <th>S&amp;D</th>
      <td>0.340735</td>
      <td>1.000000</td>
      <td>0.467581</td>
      <td>0.538453</td>
      <td>0.369880</td>
      <td>0.145775</td>
      <td>0.049879</td>
      <td>0.451704</td>
    </tr>
    <tr>
      <th>Greens/EFA</th>
      <td>0.503638</td>
      <td>0.467581</td>
      <td>1.000000</td>
      <td>0.352198</td>
      <td>0.210386</td>
      <td>0.050515</td>
      <td>0.002480</td>
      <td>0.538322</td>
    </tr>
    <tr>
      <th>REG</th>
      <td>0.237636</td>
      <td>0.538453</td>
      <td>0.352198</td>
      <td>1.000000</td>
      <td>0.473400</td>
      <td>0.206722</td>
      <td>0.086776</td>
      <td>0.337992</td>
    </tr>
    <tr>
      <th>EPP</th>
      <td>0.117117</td>
      <td>0.369880</td>
      <td>0.210386</td>
      <td>0.473400</td>
      <td>1.000000</td>
      <td>0.331453</td>
      <td>0.161767</td>
      <td>0.234946</td>
    </tr>
    <tr>
      <th>ECR</th>
      <td>0.000000</td>
      <td>0.145775</td>
      <td>0.050515</td>
      <td>0.206722</td>
      <td>0.331453</td>
      <td>1.000000</td>
      <td>0.338813</td>
      <td>0.088697</td>
    </tr>
    <tr>
      <th>IDG</th>
      <td>0.019277</td>
      <td>0.049879</td>
      <td>0.002480</td>
      <td>0.086776</td>
      <td>0.161767</td>
      <td>0.338813</td>
      <td>1.000000</td>
      <td>0.055491</td>
    </tr>
    <tr>
      <th>NI</th>
      <td>0.428293</td>
      <td>0.451704</td>
      <td>0.538322</td>
      <td>0.337992</td>
      <td>0.234946</td>
      <td>0.088697</td>
      <td>0.055491</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We will use <em>Density-based spatial clustering of applications with noise</em> (DBSCAN) to as our data clustering algorithm.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">DBSCAN</span>

<span class="n">dbscan_labels</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">affinmat_mm</span><span class="p">)</span>
<span class="n">dbscan_labels</span><span class="o">.</span><span class="n">labels_</span>
<span class="n">dbscan_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">distmat_mm</span><span class="p">,</span><span class="n">dbscan_labels</span><span class="o">.</span><span class="n">labels_</span><span class="p">))</span>
<span class="n">dbscan_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;GUE-NGL&#39;: 0,
 &#39;S&amp;D&#39;: 0,
 &#39;Greens/EFA&#39;: 0,
 &#39;REG&#39;: 0,
 &#39;EPP&#39;: 0,
 &#39;ECR&#39;: -1,
 &#39;IDG&#39;: -1,
 &#39;NI&#39;: 0}
</pre></div>
</div>
</div>
</div>
<p>We get a simple split that identified the ECR and the IDG on one side, and all the others grouped together on the other cluster.</p>
<p>A different approach is to use <em>Spectral Clustering</em>, an algorithm that can be initialised with a pre-determine naumber of clusters; here we set it at 3.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">SpectralClustering</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">SpectralClustering</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">affinity</span><span class="o">=</span><span class="s2">&quot;precomputed&quot;</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">affinmat_mm</span><span class="p">)</span>
<span class="n">sc_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">distmat</span><span class="p">,</span><span class="n">sc</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sc_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;GUE-NGL&#39;: 2, &#39;S&amp;D&#39;: 0, &#39;Greens/EFA&#39;: 2, &#39;REG&#39;: 0, &#39;EPP&#39;: 0, &#39;ECR&#39;: 1, &#39;IDG&#39;: 1, &#39;NI&#39;: 2}
</pre></div>
</div>
</div>
</div>
<p>The results are consistent with what one would expect when looking at the previous clustermap:</p>
<ul class="simple">
<li><p>One group with the ECR and IDG</p></li>
<li><p>One group with the S&amp;D, REG and EPP</p></li>
<li><p>One group with the GUE/NGL, Greens/EFA and NI</p></li>
</ul>
</div>
<div class="section" id="multidimensional-scaling">
<h2>Multidimensional Scaling<a class="headerlink" href="#multidimensional-scaling" title="Permalink to this headline">¶</a></h2>
<p>Based on what we’ve done above we can now visualise the relative distances between all the groups in a map: this can be achieved by Multi-dimensional scaling, a method that reduces the dimensions while keeping the relative distances.</p>
<p>What this means is that we can reduce to 2 or 3 dimensions and obtain a plot of how close the parties are that maintains the relative distance; we can also use the information obtained from Spectral Clustering in the form of the colours od the data points, thus combining relative distance and clustering.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">MDS</span>

<span class="n">mds</span> <span class="o">=</span> <span class="n">MDS</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dissimilarity</span><span class="o">=</span><span class="s1">&#39;precomputed&#39;</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">2020</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1">## We use the normalised distance matrix but results would</span>
<span class="c1">## be similar with the original one, just with a different scale/axis</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">mds</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">distmat_mm</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">embedding_</span>
<span class="n">coords</span>
<span class="c1">## Graphic options</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;European Parliament, MDS </span><span class="se">\n</span><span class="s1">(2020-08-01 to 2021-01-01)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">distmat_mm</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sc_dict</span><span class="p">[</span><span class="n">label</span><span class="p">]),</span> <span class="n">s</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mf">0.025</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/European_Parliament_33_0.png" src="_images/European_Parliament_33_0.png" />
</div>
</div>
<p>This view is perhaps one of the most useful in getting an overview of how the political groups relate to each other based on their voting records.</p>
<p>The 3D equivalent can be seen here:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">MDS</span>
<span class="kn">import</span> <span class="nn">mpl_toolkits.mplot3d</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="n">mds</span> <span class="o">=</span> <span class="n">MDS</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dissimilarity</span><span class="o">=</span><span class="s1">&#39;precomputed&#39;</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">2020</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1">## We use the normalised distance matrix but results would</span>
<span class="c1">## be similar with the original one, just with a different scale/axis</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">mds</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">distmat_mm</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">embedding_</span>
<span class="n">coords</span>
<span class="c1">## Graphic options</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;European Parliament, MDS </span><span class="se">\n</span><span class="s1">(2020-08-01 to 2021-01-01)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MDS with Spectrum Scaling clusters (3D)&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">distmat_mm</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">coords</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]):</span>
    <span class="c1">#ax.scatter(x, y, c = &quot;C&quot;+str(sc_dict[label]), s=250)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sc_dict</span><span class="p">[</span><span class="n">label</span><span class="p">]),</span><span class="n">s</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
    <span class="n">annotate3D</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">),</span> <span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
               <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_582984/115050311.py:15: MatplotlibDeprecationWarning: 
The M attribute was deprecated in Matplotlib 3.4 and will be removed two minor releases later. Use self.axes.M instead.
  xs, ys, zs = proj_transform(xs3d, ys3d, zs3d, renderer.M)
</pre></div>
</div>
<img alt="_images/European_Parliament_36_1.png" src="_images/European_Parliament_36_1.png" />
</div>
</div>
</div>
<div class="section" id="mds-per-policy-area">
<h2>MDS per Policy Area<a class="headerlink" href="#mds-per-policy-area" title="Permalink to this headline">¶</a></h2>
<p>Finally we can apply the 2D MDS and clustering to each individual Policy Area; the approach is the same but applied to a subset of the votes, providing the relative distance of the parties in the different domains.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">area</span> <span class="ow">in</span> <span class="n">eu_v</span><span class="p">[</span><span class="s2">&quot;Policy Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">varea</span><span class="o">=</span><span class="n">eu_v</span><span class="p">[</span><span class="n">eu_v</span><span class="p">[</span><span class="s2">&quot;Policy Area&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">area</span><span class="p">]</span>
    <span class="n">avotes_hm</span><span class="o">=</span><span class="n">varea</span><span class="p">[[</span><span class="s2">&quot;GUE-NGL&quot;</span><span class="p">,</span><span class="s2">&quot;S&amp;D&quot;</span><span class="p">,</span> <span class="s2">&quot;Greens/EFA&quot;</span><span class="p">,</span> <span class="s2">&quot;REG&quot;</span><span class="p">,</span> <span class="s2">&quot;EPP&quot;</span><span class="p">,</span> <span class="s2">&quot;ECR&quot;</span><span class="p">,</span> <span class="s2">&quot;IDG&quot;</span><span class="p">,</span> <span class="s2">&quot;NI&quot;</span><span class="p">]]</span>
    <span class="n">avotes_hmn</span> <span class="o">=</span> <span class="n">avotes_hm</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s2">&quot;For&quot;</span><span class="p">,</span> <span class="s2">&quot;Against&quot;</span><span class="p">,</span> <span class="s2">&quot;Abstain&quot;</span><span class="p">,</span> <span class="s2">&quot;No political line&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
 
    <span class="n">avotes_t</span> <span class="o">=</span> <span class="n">avotes_hmn</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">apwdist</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">avotes_t</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
    <span class="n">adistmat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">squareform</span><span class="p">(</span><span class="n">apwdist</span><span class="p">),</span> <span class="c1"># pass a symmetric distance matrix</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">avotes_t</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">avotes_t</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="n">adistmat_mm</span><span class="o">=</span><span class="p">((</span><span class="n">adistmat</span><span class="o">-</span><span class="n">adistmat</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span><span class="p">(</span><span class="n">adistmat</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">adistmat</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span><span class="o">*</span><span class="mi">1</span>
    
    <span class="n">aaffinmat_mm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">distmat_mm</span><span class="p">,</span> <span class="n">distmat</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">adistmat</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="n">asc</span> <span class="o">=</span> <span class="n">SpectralClustering</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">affinity</span><span class="o">=</span><span class="s2">&quot;precomputed&quot;</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">aaffinmat_mm</span><span class="p">)</span>
    <span class="n">asc_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">adistmat</span><span class="p">,</span><span class="n">asc</span><span class="p">))</span>   
    
    <span class="n">amds</span> <span class="o">=</span> <span class="n">MDS</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dissimilarity</span><span class="o">=</span><span class="s1">&#39;precomputed&#39;</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">2020</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">aresults</span> <span class="o">=</span> <span class="n">amds</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adistmat_mm</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">acoords</span> <span class="o">=</span> <span class="n">aresults</span><span class="o">.</span><span class="n">embedding_</span>
    
    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">adistmat_mm</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">acoords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">acoords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">asc_dict</span><span class="p">[</span><span class="n">label</span><span class="p">]),</span> <span class="n">s</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
        <span class="c1">#ax.scatter(x, y, s=250)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mf">0.025</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/European_Parliament_39_0.png" src="_images/European_Parliament_39_0.png" />
<img alt="_images/European_Parliament_39_1.png" src="_images/European_Parliament_39_1.png" />
<img alt="_images/European_Parliament_39_2.png" src="_images/European_Parliament_39_2.png" />
<img alt="_images/European_Parliament_39_3.png" src="_images/European_Parliament_39_3.png" />
<img alt="_images/European_Parliament_39_4.png" src="_images/European_Parliament_39_4.png" />
<img alt="_images/European_Parliament_39_5.png" src="_images/European_Parliament_39_5.png" />
<img alt="_images/European_Parliament_39_6.png" src="_images/European_Parliament_39_6.png" />
<img alt="_images/European_Parliament_39_7.png" src="_images/European_Parliament_39_7.png" />
<img alt="_images/European_Parliament_39_8.png" src="_images/European_Parliament_39_8.png" />
<img alt="_images/European_Parliament_39_9.png" src="_images/European_Parliament_39_9.png" />
<img alt="_images/European_Parliament_39_10.png" src="_images/European_Parliament_39_10.png" />
<img alt="_images/European_Parliament_39_11.png" src="_images/European_Parliament_39_11.png" />
<img alt="_images/European_Parliament_39_12.png" src="_images/European_Parliament_39_12.png" />
<img alt="_images/European_Parliament_39_13.png" src="_images/European_Parliament_39_13.png" />
<img alt="_images/European_Parliament_39_14.png" src="_images/European_Parliament_39_14.png" />
<img alt="_images/European_Parliament_39_15.png" src="_images/European_Parliament_39_15.png" />
<img alt="_images/European_Parliament_39_16.png" src="_images/European_Parliament_39_16.png" />
<img alt="_images/European_Parliament_39_17.png" src="_images/European_Parliament_39_17.png" />
<img alt="_images/European_Parliament_39_18.png" src="_images/European_Parliament_39_18.png" />
<img alt="_images/European_Parliament_39_19.png" src="_images/European_Parliament_39_19.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="Presidenciais_2021_wiki.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">2021 Presidential Elections: using GeoJSON and Wikipedia</p>
            </div>
        </a>
    </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Frederico Muñoz<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>